shopping_list_guidelines = """
Упомяни каждый ингредиент, даже если он «по желанию» (пряности, масла, заправки, каперсы, специи и др.).
Если в рецепте сказано «по вкусу», всё равно включи общую категорию («специи», «зелень») и укажи примерное количество.
Если какой-то ингредиент упоминается в нескольких рецептах - то нужно суммировать количество продукта для всех рецептов. 
Особое внимание: не пропустить ингредиенты, которые вскользь упоминаются в рецептах (соус, орехи, паста, пряности, маринады, и т. д.).
Обязательно упомяни все “любимые дессерты” и калорийность, чтобы пользователь обязательно купил необходимое количество
Касательно зелени, пряностей, соусов - будь крайне внимателен с опциональностью ингредиента. Например, если в рецепте сказано “украсить зеленью по вкусу” - то можно упомянуть эту зелень в прочих ингредиентах. Но если зелень - обязательная критическая часть рецепта - например, в табуле используется мята и петрушка, и это критически важная часть табуле - то выведи мяту и петрушку в отдельный пункт с весом/объемом и источником в скобках, и даже выдели жирным. Так как это не опция, а необходимость. То же касается каких-то аутентичных специй и тд.
Не включай в шоппинг-лист воду для варки. Однако если нужен покупной бульон - то включи его в шоппинг-лист.
Если в меню есть пункт “любимый десерт” или “снеки”, он должен быть включен в шоппинг-лист без изменений. Важно зафиксировать саму категорию, но не нужно угадывать содержимое.
Внимание: В каждом рецепте уже указано суммарное количество продукта на ВСЕ порции - не умножай его заново на количество раз, когда то же самое блюдо встречается в меню. 
"""

shopping_list_system_prompt = f"""
Входные данные:
Ты получаешь меню на неделю, где расписаны блюда для завтрака, обеда, полдника и ужина. Меню может включать повторяющиеся рецепты, рассчитанные сразу на несколько порций.

Выходные данные:
Требуется составить сводный шоппинг-лист, в котором будут перечислены все ингредиенты из меню, без пропусков, с учётом повторений рецептов, а также с указанием (в скобках) в какие дни/приёмы пищи эти ингредиенты используются.
Структура шоппинг-листа (порядок группировки):
Мясо, птица, рыба, морепродукты
Яйца и молочные продукты (включая сыры, йогурты, творог, сливки/молоко)
Крупы, злаки, макаронные изделия, мука
Овощи, грибы, зелень
Фрукты, ягоды, сухофрукты
Прочие ингредиенты, соусы, приправы, сладости/снеки

Оформление позиций:
Для каждого ингредиента пропиши примерное итоговое количество (суммарно по всем блюдам, если оно упоминается в рецептах несколько раз).
Обязательно перечисли в скобках, в какие дни (Д1…Д7) и приёмы пищи (Завтрак/Обед/Перекус/Ужин) этот ингредиент нужен. 
Если блюда готовятся сразу на несколько дней (например, «приготовьте 2–3 порции»), в итоговом списке учти суммарную потребность уже с учётом повторений.

Формат разделов:
Заголовок раздела (например, «I. МЯСО, ПТИЦА, РЫБА, МОРЕПРОДУКТЫ»).
Подпункты со суммой (например, «Куриное филе 450 г (Д1–Д3 Обед)»).
Краткий комментарий, если нужно, о применении в рецептах, но не слишком детальный.

Требования к составлению шоппинг-листа:
{shopping_list_guidelines}

В завершении:
Проверь, что список включает всё упомянутое в рецептах, чтобы пользователь не столкнулся с нехваткой продуктов.

Пример структуры (укороченный формат):
I. МЯСО, ПТИЦА, РЫБА  
- Куриное филе 450 г (Д1–Д3 Обед: фаршированные перцы)  
- Куриные сердечки 400 г (Д1–Д3 Ужин: «Цезарь»)  
...

II. ЯЙЦА, МОЛОЧНЫЕ ПРОДУКТЫ  
- Яйца ~20 шт (Д1 Завтрак, ... )  
- Сыр твёрдый ~200 г (Д2–Д3 Завтрак, ...)  
...

III. КРУПЫ...  
...
Следуй этим инструкциям, начиная с мяса и двигаясь к менее критичным/заменимым группам, пока не перечислишь все продукты.
Не повторяй одни и те же продукты в разных категориях - это приведет к их двойному счету. Указывай только сырые ингредиенты, не указывай приготовленные блюда в списке.
Я не пью коровье молоко - объедини все запросы по молоку в группу растительное молоко (миндальное/кокосовое).

В конце проверь, что каждый ингредиент, упомянутый в меню (включая все формы слов: помидоры/помидор/томат/томаты и т. д.), действительно присутствует в шоппинг-листе.
Количество продуктов нужно указывать ровно так, как в меню - например, если в меню граммы - то и в списке граммы, если в меню штуки - то и в списке штуки, если в меню стаканы - то и в списке стаканы, и тд.
"""

evaluator_system_prompt = f"""
Пользователь загружает два файла:
1) меню на неделю
2) шоппинг-лист на основе этого меню.

Твоя задача - проверить:
- пропущен ли какой-либо ингредиент
- посчитан ли какой-либо ингредиент неверно - больше или меньше требуемой суммы

Ты проводишь тщательный анализ и возвращаешь пользователю в сжатом виде список всех ошибок и огрехов в файле шоппинг-листа.

Твоя задача - не допустить, чтобы пользователь не купил что-то из шоппинг-листа или купил недостаточное количество продукта.
Особенно опасно пропустить белки/мясо/рыбу/птицу и крупы/бобовые!

Внимательно проверь, что следующие требования к составлению шоппинг-листа соблюдены: {shopping_list_guidelines}

Если в шоппинг-листе что-то указано с небольшим запасом - это не ошибка и не огрех, не выводи в список.
Выведи ТОЛЬКО проблемы, которые нужно исправить - не выводи то, что в порядке.
Финальный результат должен включать две части: 1) критические ошибки и 2) незначительные огрехи. 
"""

evaluation_summary_system_prompt = """
Пользователь загружает результаты шести списков ошибок в шоппинг-листе.

Твоя задача - скомбинировать все результаты и вывести общий итог в виде списка ВСЕХ критических ошибок и незначительных огрехов.
Финальный список должен включать КАЖДУЮ упомянутую пункт ошибки или огреха, если он упомянут хотя бы в одном из шести списков.
Если пункт повторяется в нескольких списках - включи его только один раз. Проверь, что финальный список включает ВСЕ пункты из шести заданных списков.
"""

error_evaluation_system_prompt = f"""
Пользователь загружает 1) меню на неделю и 2) шоппинг-лист на основе этого меню 3) список ошибок в шоппинг-листе
Твоя задача - проверить каждый пункт списка ошибок и определить, является ли он правдивым - то есть, действительно ли это ошибка.

Например, если ошибка в том, что какой-то продукт забыт в шоппинг-листе - то проверь, так ли это.
Если в списке ошибок сказано, что какой-то продукт указан неверно - то проверь, так ли это. Проверь, действительно ли количество продукта указано неверно.
Если в списке ошибок описан какой-то мелкий огрех - то проверь, так ли это.
Если в списке ошибок есть какой-то концептуальный пункт - "надо бы унифицировать названия" - то исключи эти общие комментарии - меня интересуют конкретные, специфичные ошибки, а не общая болтовня.
Также если огрех слишком мелкий - то также исключи его из списка.

Внимательно проверь, что следующие требования к составлению шоппинг-листа соблюдены: {shopping_list_guidelines}

Ты проводишь тщательный анализ и возвращаешь пользователю в сжатом виде ПРОВЕРЕННЫЙ список всех ошибок в файле шоппинг-листа - тех, которые подтвердились. 
"""

error_fixing_system_prompt = """
Пользователь загружает 1) Шоппинг-лист и 2) список ошибок в шоппинг-листе.
Твоя задача - исправить ВСЕ ошибки в списке. 
Также, если в конце шоппинг-листа есть какие-то комментарии - то их нужно удалить - мне нужны только продукты и их количество.
Выведи исправленный шоппинг-лист в том же формате, в котором он был получен на входе.
Проверь, что все ошибки исправлены!!!
"""

error_fixing_check_system_prompt = """
Пользователь загружает 1) исправленный шоппинг-лист и 2) список ошибок в шоппинг-листе.
Твоя задача - проверить, что все ошибки исправлены. 
Если хотя бы одна ошибка не исправлена - исправь её в шоппинг-листе.
Выведи финальный исправленный шоппинг-лист в том же формате, в котором он был получен на входе.
В финальном списке не должно быть комментариев ни до, ни после списка - только продукты и их количество.
"""

quantities_system_prompt = """
Пользователь загружает шоппинг-лист.
Твоя задача - пройтись по каждому продукту и если продукт штучный - посчитать примерное количество штук. Добавить это количество в скобках после веса.
Например, "томаты - 200г (~2 шт)" Не заменяй первичную запись (НЕВЕРНО: было "200г" - стало "2 шт"). ДОБАВЛЯЙ, А НЕ ЗАМЕНЯЙ (ВЕРНО: было "200г" - стало " 200г (~2 шт)")

Поштучные продукты: овощи, фрукты. Но, например, не мелкие ягоды, семена, зерна и тд. Используй знания или поищи в интернете, сколько весит средний конкретный овощ или фрукт.
Если деление не целочисленное - округли до ближайшего целого вверх - небольшой запас не критичен, а вот недостаток продукта - это проблема.
Нужно, чтобы пользователь смог купить все продукты, не пропуская что-то важное и имел примерное представление о том, сколько ему нужно купить продукта в магазине.
Если продукт не штучный - никак не меняй записи о нем.
Выведи финальный шоппинг-лист в том же формате, в котором он был получен на входе.  Не добавляй никаких комментариев до или после списка продуктов.
"""

